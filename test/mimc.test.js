import { describe, it } from 'micro-should';
import mimc7 from '../src/mimc7.js';
import mimcGenContract from '../src/mimc_gencontract.js';
import { assert } from './test_utils.js';

const SEED = 'mimc';

describe('MiMC contract', async () => {
  it('iv', () => {
    assert.equal(
      mimc7.getIV().toString(),
      '15021630795539610737508582392395901278341266317943626182700664337106830745361'
    );
  });
  it('constants', () => {
    const cts = mimc7.getConstants();
    assert.equal(cts, [
      0n,
      20888961410941983456478427210666206549300505294776164667214940546594746570981n,
      15265126113435022738560151911929040668591755459209400716467504685752745317193n,
      8334177627492981984476504167502758309043212251641796197711684499645635709656n,
      1374324219480165500871639364801692115397519265181803854177629327624133579404n,
      11442588683664344394633565859260176446561886575962616332903193988751292992472n,
      2558901189096558760448896669327086721003508630712968559048179091037845349145n,
      11189978595292752354820141775598510151189959177917284797737745690127318076389n,
      3262966573163560839685415914157855077211340576201936620532175028036746741754n,
      17029914891543225301403832095880481731551830725367286980611178737703889171730n,
      4614037031668406927330683909387957156531244689520944789503628527855167665518n,
      19647356996769918391113967168615123299113119185942498194367262335168397100658n,
      5040699236106090655289931820723926657076483236860546282406111821875672148900n,
      2632385916954580941368956176626336146806721642583847728103570779270161510514n,
      17691411851977575435597871505860208507285462834710151833948561098560743654671n,
      11482807709115676646560379017491661435505951727793345550942389701970904563183n,
      8360838254132998143349158726141014535383109403565779450210746881879715734773n,
      12663821244032248511491386323242575231591777785787269938928497649288048289525n,
      3067001377342968891237590775929219083706800062321980129409398033259904188058n,
      8536471869378957766675292398190944925664113548202769136103887479787957959589n,
      19825444354178182240559170937204690272111734703605805530888940813160705385792n,
      16703465144013840124940690347975638755097486902749048533167980887413919317592n,
      13061236261277650370863439564453267964462486225679643020432589226741411380501n,
      10864774797625152707517901967943775867717907803542223029967000416969007792571n,
      10035653564014594269791753415727486340557376923045841607746250017541686319774n,
      3446968588058668564420958894889124905706353937375068998436129414772610003289n,
      4653317306466493184743870159523234588955994456998076243468148492375236846006n,
      8486711143589723036499933521576871883500223198263343024003617825616410932026n,
      250710584458582618659378487568129931785810765264752039738223488321597070280n,
      2104159799604932521291371026105311735948154964200596636974609406977292675173n,
      16313562605837709339799839901240652934758303521543693857533755376563489378839n,
      6032365105133504724925793806318578936233045029919447519826248813478479197288n,
      14025118133847866722315446277964222215118620050302054655768867040006542798474n,
      7400123822125662712777833064081316757896757785777291653271747396958201309118n,
      1744432620323851751204287974553233986555641872755053103823939564833813704825n,
      8316378125659383262515151597439205374263247719876250938893842106722210729522n,
      6739722627047123650704294650168547689199576889424317598327664349670094847386n,
      21211457866117465531949733809706514799713333930924902519246949506964470524162n,
      13718112532745211817410303291774369209520657938741992779396229864894885156527n,
      5264534817993325015357427094323255342713527811596856940387954546330728068658n,
      18884137497114307927425084003812022333609937761793387700010402412840002189451n,
      5148596049900083984813839872929010525572543381981952060869301611018636120248n,
      19799686398774806587970184652860783461860993790013219899147141137827718662674n,
      19240878651604412704364448729659032944342952609050243268894572835672205984837n,
      10546185249390392695582524554167530669949955276893453512788278945742408153192n,
      5507959600969845538113649209272736011390582494851145043668969080335346810411n,
      18177751737739153338153217698774510185696788019377850245260475034576050820091n,
      19603444733183990109492724100282114612026332366576932662794133334264283907557n,
      10548274686824425401349248282213580046351514091431715597441736281987273193140n,
      1823201861560942974198127384034483127920205835821334101215923769688644479957n,
      11867589662193422187545516240823411225342068709600734253659804646934346124945n,
      18718569356736340558616379408444812528964066420519677106145092918482774343613n,
      10530777752259630125564678480897857853807637120039176813174150229243735996839n,
      20486583726592018813337145844457018474256372770211860618687961310422228379031n,
      12690713110714036569415168795200156516217175005650145422920562694422306200486n,
      17386427286863519095301372413760745749282643730629659997153085139065756667205n,
      2216432659854733047132347621569505613620980842043977268828076165669557467682n,
      6309765381643925252238633914530877025934201680691496500372265330505506717193n,
      20806323192073945401862788605803131761175139076694468214027227878952047793390n,
      4037040458505567977365391535756875199663510397600316887746139396052445718861n,
      19948974083684238245321361840704327952464170097132407924861169241740046562673n,
      845322671528508199439318170916419179535949348988022948153107378280175750024n,
      16222384601744433420585982239113457177459602187868460608565289920306145389382n,
      10232118865851112229330353999139005145127746617219324244541194256766741433339n,
      6699067738555349409504843460654299019000594109597429103342076743347235369120n,
      6220784880752427143725783746407285094967584864656399181815603544365010379208n,
      6129250029437675212264306655559561251995722990149771051304736001195288083309n,
      10773245783118750721454994239248013870822765715268323522295722350908043393604n,
      4490242021765793917495398271905043433053432245571325177153467194570741607167n,
      19596995117319480189066041930051006586888908165330319666010398892494684778526n,
      837850695495734270707668553360118467905109360511302468085569220634750561083n,
      11803922811376367215191737026157445294481406304781326649717082177394185903907n,
      10201298324909697255105265958780781450978049256931478989759448189112393506592n,
      13564695482314888817576351063608519127702411536552857463682060761575100923924n,
      9262808208636973454201420823766139682381973240743541030659775288508921362724n,
      173271062536305557219323722062711383294158572562695717740068656098441040230n,
      18120430890549410286417591505529104700901943324772175772035648111937818237369n,
      20484495168135072493552514219686101965206843697794133766912991150184337935627n,
      19155651295705203459475805213866664350848604323501251939850063308319753686505n,
      11971299749478202793661982361798418342615500543489781306376058267926437157297n,
      18285310723116790056148596536349375622245669010373674803854111592441823052978n,
      7069216248902547653615508023941692395371990416048967468982099270925308100727n,
      6465151453746412132599596984628739550147379072443683076388208843341824127379n,
      16143532858389170960690347742477978826830511669766530042104134302796355145785n,
      19362583304414853660976404410208489566967618125972377176980367224623492419647n,
      1702213613534733786921602839210290505213503664731919006932367875629005980493n,
      10781825404476535814285389902565833897646945212027592373510689209734812292327n,
      4212716923652881254737947578600828255798948993302968210248673545442808456151n,
      7594017890037021425366623750593200398174488805473151513558919864633711506220n,
      18979889247746272055963929241596362599320706910852082477600815822482192194401n,
      13602139229813231349386885113156901793661719180900395818909719758150455500533n,
    ]);
  });
  it('contract', () => {
    assert.equal(
      mimcGenContract.createCode(SEED, 91),
      '0x38600c6000396112636000f3604460006000377c01000000000000000000000000000000000000000000000000000000006000510463d15ca109146200003557fe5b7f30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f0000001602451818060045183088180828009818180090909828080927f8ef758973a8cabb7492f4d05f39a1b93dc29a57c0104feffb67c57dfc70a98e70883088180828009818180090909828080927f82885e3a7813b2259da69bc36657e8bc48c092832474ec6eb0de5dc54281d34b0883088180828009818180090909828080927fa399e58dcea3077e6d1c08044780913ff598f4d83a1494638c89c8495edb4adb0883088180828009818180090909828080927f63d273ec3d199e351a406dac488fbc7e41f42a4757a1d5ad842b8a195cb6928e0883088180828009818180090909828080927f7a14e37902fca6e97c891080d2e5da42118dc7a48c1a6406d137e6b2d4798bda0883088180828009818180090909828080927fc7398333d08c0d67b82b09f3bae043e25241145ddcf4f41e886bf359675a631d0883088180828009818180090909828080927f49219c213265f3b58b4952f83d333b8ddadc10b41e5a0b5b839dd28d22534be60883088180828009818180090909828080927ff92c4e4b3997f23536d9a245812da66d75ac291d3ea970553e280f33fb5607ff0883088180828009818180090909828080927f560ae58d7e5dbe13abc47d4410e2a1884407acadfe79e738b025b9610a7475130883088180828009818180090909828080927f9b605f2a033bbd5f4ae9034a44b14b10274188a04778f0fd4d5382791b50f5710883088180828009818180090909828080927fed013c59b0bb60afc36ff4919346f24bdcf83ee82b4101a9f0e76220ac02c6760883088180828009818180090909828080927f6bed8c2bdcd52f2cae73f1a1329f55a90bdc6d1b4dd338ea899923efa0666ba60883088180828009818180090909828080927f05d1e0ac576d1ec814b621516339ae1a291c7df36b5fd6cf0b4e3c9cd25e30720883088180828009818180090909828080927fb849e751322c2535825f4f50ecf9d117d5aa1adaad3cfde9b5005d9e090bc5120883088180828009818180090909828080927f196309f1d170d741ab1ce90c39772017fb7cdec78c37882b98a6b56956c13def0883088180828009818180090909828080927fa3a8fc6f690aa0b9a85e54650210244f8194e7bad650f6f46064ea02f1e9e4f80883088180828009818180090909828080927f7cc814ea4149bd8c15f067c1129cdc5acfcb192bc0a92381a2a5fbd4129826f70883088180828009818180090909828080927ff8bd64ba20de36cd8b1acbbc153e92fdcedfa80c28b281740a67246a22c53e9f0883088180828009818180090909828080927fd470b297263c701dbd3de0a18b97cd28356a290e5c19a49aa9af7c9b51cebba90883088180828009818180090909828080927f2bd4cdc962e3da62cb3c96f7c428a9b0d518bfa7ce26f8fce7a6af769afb65400883088180828009818180090909828080927fb61abedd23809ec1edbd0a25cb6740b2c098ba799dfd1ebf1b756078ecabfe5b0883088180828009818180090909828080927fde719f9e471c9c5c5525e61c5fd912258aba6c665e378870875892ae0e3c7d190883088180828009818180090909828080927f18053e9f0d45f9eefbda135bfd39329e34837e633565c314fb9030b9db7381bb0883088180828009818180090909828080927fa75ce5dfe5a86c3b7a5239e30b7081c925ba442cc7f0a75b9b61037d0f9c5aa10883088180828009818180090909828080927ff99472814762e714c63982b48395476c9c9cf3b208a071801edd5170542b715e0883088180828009818180090909828080927f3aadfd9e9f435085887aaf5afc9d05b849a428c353da84c04ac6d69dce88a1b70883088180828009818180090909828080927f43279d5e9bd83cf67bb96f9f76283c649a153c47f14dae36a031bdf4437b733b0883088180828009818180090909828080927ff2836dead1465663cf48597615479fb608d63867e759f63111c167705ce5dbcd0883088180828009818180090909828080927ff69c71c71b05b227ce508f275fb711d1afa8da62f91d786e12519f177d24a86a0883088180828009818180090909828080927fb53e118c3601dcdd51eb0121238d1435ccc45981ea9d69e939ee96904044921a0883088180828009818180090909828080927f0d56329982f3df38a3f19fb814c3013f419ba0eb8403b27c0c0e75c6fe1cf4680883088180828009818180090909828080927fe093294bfb03169c1d84583e4f42f7e84fbeca2dd88fdbdce5ff8ba779692e8e0883088180828009818180090909828080927f40c0a0cad932f2a819007bd28188b3b7a206c4b09b9211b6d172646843c7e7bf0883088180828009818180090909828080927f64a3ed3fce960bb53aaa1ef6c51abed6d3ea50451112cea7604b520724c6307b0883088180828009818180090909828080927f42c735abd4bf56f155751f28f4159a7a018ee26d6e297ca4678d7957906ace330883088180828009818180090909828080927f0ee68c3e38c194033994c0d4d7bde35bfafa35b22a95f915f82c5a3b0422bd9a0883088180828009818180090909828080927f8faddf61946f884c4391360b671ca84cbb24a62743f70a4d6d11c2a7e77e69040883088180828009818180090909828080927f4eb87ba4b3d521a2e65ad7f845e381ff580d206cbd9d943227fbc692a58656b00883088180828009818180090909828080927f3c07ed74275c56d187b25f08f6b12641aeabc03ba7adef25528eea293c5ef6330883088180828009818180090909828080927feb5144d110de00a827fed745247960d1b0c4df1b566a25c69b8d4920dfcaf88f0883088180828009818180090909828080927f9c8eebe1fef58743a240a03faf9f1ee7b30cf569c7b7f3a4fd0555bdce1a50bb0883088180828009818180090909828080927fbcf3250a5bf2539c8bc39817165852a5b1c8703849e9adffdb4e932902d68a150883088180828009818180090909828080927f5aee420145726e8dc9774a21e95a3e731978ec1fa7302fcdb41bf765363a84460883088180828009818180090909828080927fa87dd94092802f5aa12987a330f12e21cca117c81a3d384f0613ffc33ca8786b0883088180828009818180090909828080927f6cf601ee0e4e12fab3b1e75235a0051322ffd29912e27ecec929af4e31f9be2d0883088180828009818180090909828080927fe9c177f908149788df74e085786f9fea7ddd4ebde587667776a1746ee43993ff0883088180828009818180090909828080927fece861dd4efb6af7f2121e4cead434d78cbf78ef04fe46fc797119a8d4efc5e90883088180828009818180090909828080927fa87f07fe1d34c367abb74d2e118c6ccd675ca874dd6a6b119fa897bc5b53f6b70883088180828009818180090909828080927fc5991f171b6c36e341e0ba5381279de873304487943e749da12d3c5232096bd90883088180828009818180090909828080927f7b056e3b729fbd873d22ae369a44fc7b90d1b37eb2be6bc7ec8dd0ab0bdace930883088180828009818180090909828080927f296255b5e697e517c502ba49b18aaad89514a490a02e7a878b5d559841b93fbd0883088180828009818180090909828080927fd8d96f4b9ee595cc96032f2dbf6b26792bc4070bde83ac1676d09cc913da79ab0883088180828009818180090909828080927f5daf4d4a883a85c0e6d51d1caab084e144916db90fc9e566deb5eab28369a5980883088180828009818180090909828080927f4c72feda25fb2697df6d185100994f868d2ea2854a4229efb7bec43182c79ba70883088180828009818180090909828080927fb79d49d6f2b88854af9de8aa37d7ac1030be22a122b708c14739d4d255d34d480883088180828009818180090909828080927f04e674d88b90b1188353106ae25c0447acace9dc6d62cfe7fec2d7993dfd7a220883088180828009818180090909828080927f9f201eb644d4d4ec8dfa30bae199819d9cb6a5a960bc2b6f74cc25b4669d7e0c0883088180828009818180090909828080927f5e64449e73b48c2f6a4a89fe1beff64911e04b608d8c219f889bd69209e4d4ef0883088180828009818180090909828080927f395130bbdf4e81f728a6df6c4e8921ee145b5a64251326e8fef583dc6ee6694e0883088180828009818180090909828080927f8ce35503786afaca4c97aab5782f362641ead4da753697f484f59ca18078f5730883088180828009818180090909828080927ff3d3f7c6ec7eaf05b586273db0c292409ba27fa271808f8e5cbdf9e56fbbcb8d0883088180828009818180090909828080927f23dd8b576fa286331864d63c77fd82fa61da717533821b9382617ebd54abeb460883088180828009818180090909828080927fa7cc17e6f4f00d6bb6090ab547f5304d78b6386c68611597c0d8bf7f43aacbfe0883088180828009818180090909828080927f6f98269e5b461f1e0a4edc75d574a2b4e34cd21d0e3b7af7dca0092215ceb0a20883088180828009818180090909828080927fcf5210b2efc2241ebeaa55aeca7fb1148f4a29f3c643b874dff705d7781de1cc0883088180828009818180090909828080927f3df156c9f66b66b3f02b185ce503ea304bc876a019d20b0d26ce0a6c8308bb6e0883088180828009818180090909828080927f789a0dccf9b67ee59d33dae6bdd67349d656e5430fe635228a5cba1056977a460883088180828009818180090909828080927f6ab5fff302ec18001ad491b218c47bf0df3bd655d2454f160e16bdb8926f6b010883088180828009818180090909828080927f5bb7d0071f06646588a9ea2afcf4546e973d848e7a0738a32196368bde69701f0883088180828009818180090909828080927f62a2d1cf4a4ca616d98c8dbfec80697a07ee396c2a0fc08ef8bbcb533bd52b3d0883088180828009818180090909828080927fdbaa026275eb4def033cf764cc8618f80390f4664882b14c37fcca8759b89f270883088180828009818180090909828080927f775657d6ad46103ce00bbf79004bd37c147ae850f2dc425e099d5d5614059f220883088180828009818180090909828080927f4e61a6ea081de44f1e3b8db283b5cc635cea3e75951989ba8af6011a60aa40150883088180828009818180090909828080927f44dedebeae494420270dbb6942a8ed6428524870bc59b823e3b30f670edf39250883088180828009818180090909828080927f612aae4aab14ba9ad2137997aedc5260cf33d68a1a31a6de34af604c416e11680883088180828009818180090909828080927f88d869cee1f54bb7f88ec9d7868d6c7c4853157578ae03f2ef695a86708499bb0883088180828009818180090909828080927feedb0a063b7dc1f03f8e93988defce65913a8ba8dc0e9382677e76ae0c868d0f0883088180828009818180090909828080927f5abe0556f1b6cdc01e64bece120307961cac9fa8b86d558375db8bc7c826cdea0883088180828009818180090909828080927f7b4020e0625af3c0a94f42cb68d2793cb11eddd6f427fbd7fc224b09bc35d9b30883088180828009818180090909828080927fe9fe58498866232db2fea6c0a41cc03f76e634ee063ac68d56a0f1fdeff344b60883088180828009818180090909828080927f7069a5c1ab448edfc3a9cb07b2224957fc1bac936371ac27250156730c9b80790883088180828009818180090909828080927f6f13c2492208c1a3f33cc9f02f461279f855ce84fe77f5e29597925b6131f1950883088180828009818180090909828080927fe542243d3d82547243f858bf2bfb2a27fd8f8ea3f194d479dfc21ca58df7103d0883088180828009818180090909828080927fbbfbc0cb7f9206e17f81022078150aae7b9355992b6458c854f5a08355dad0420883088180828009818180090909828080927f94f0568cb0a7bb6f6b20bcf4dec92b0ac9e149312fdc4f1be26c605f5b3cc3500883088180828009818180090909828080927f483a9a75f05ad6c5c2501ae048d483e14ac25237e7934a6bf9e5b01abb9254e80883088180828009818180090909828080927fcae189fec307b78ba87c57dbb105ed6ac676dd7396bba9c4a94ddd1a3ace63db0883088180828009818180090909828080927f10ca0fd2a95bc198763d375f566182463e0c92ea122df6485f1c4e5a9769b32c0883088180828009818180090909828080927f8abed979216162a193fde6b6bb882963cb8d97ca96b5b5c360cca4b6d757db630883088180828009818180090909828080927fdfa3c38474b954d892b9d36f82c6258ebe41d8276278194218968a15f66b9ef908830881808280098181800909090860005260206000f3'
    );
  });
  it('hash', () => {
    assert.equal(
      mimc7.hash(1, 2, 91),
      10594780656576967754230020536574539122676596303354946869887184401991294982664n
    );
  });
});
it.runWhen(import.meta.url);
